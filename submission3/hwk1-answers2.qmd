---
title: "Homework 1"
subtitle: "Research in Health Economics, Spring 2024"
author: "Ria Dharnidharka"
format:
  pdf:
    output-file: "dharnidharka-r-hwk1-3"
    output-ext:  "pdf"
    header-includes:
      - \usepackage{float}
      - \floatplacement{table}{H}
---
```{r}
#| include: false

if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, ggplot2, dplyr, lubridate, readr, readxl, hrbrthemes, fixest,
               scales, gganimate, gapminder, gifski, png, tufte, plotly, OECD,
               ggrepel, survey, foreign, devtools, pdftools, kableExtra, modelsummary,
               kableExtra)
```
```{r}
#| include: false
#| eval: true
 
load("Hwk1_workspace2.Rdata")
```
\newpage

# Enrollment Data
Answer the following based on the enrollment data:

\vspace{.2in}
\noindent 1. How many observations exist in your current dataset?<br>

In the current dataset, there are 13,276,162 total observations. 

\newpage
\noindent 2. How many different *plan_types* exist in the data? <br>

There are 18 total different plan types. 

\newpage
\noindent 3. Provide a table of the count of plans under each plan type in each year.<br>

```{r} 
#| echo: false
#| label: tbl-plans
#| tbl-cap: "Plan types by year"

options(knitr.kable.NA = 0)
knitr::kable(plan.type.year1, 
             col.names=c("Plan Type","2010","2011",
                         "2012","2013","2014","2015"),
             format.args=list(big.mark=","), booktabs = TRUE) %>%
             kable_styling(latex_options=c("scale_down"))
```
\newpage
\noindent 4. Remove all special needs plans (SNP), employer group plans (eghp), and all "800-series" plans. Provide an updated table after making these exclusions.

```{r}
#| echo: false
#| label: tbl-plans2
#| tbl-cap: Revised plan types by year

options(knitr.kable.NA = 0)
knitr::kable(plan.type.year2, 
             col.names=c("Plan Type","2010","2011",
                         "2012","2013","2014","2015"),
             format.args=list(big.mark=","), booktabs = TRUE) %>%
             kable_styling(latex_options=c("scale_down"))
``` 
\newpage
\noindent 5. Merge the the contract service area data to the enrollment data and restrict the data only to contracts that are approved in their respective counties. Limit your dataset only to plans with non-missing enrollment data. Provide a graph showing the average number of Medicare Advantage enrollees per county from 2008 to 2015.<br>


```{r}
#| echo: false
#| label: fig-enroll
#| fig-cap: "Average Enrollment"

fig.avg.enrollment
```
\newpage
# Premium Data

\noindent 6. Merge the plan characteristics data to the dataset you created in Step 5 above. Provide a graph showing the average premium over time. Don't forget about formatting!<br>


```{r}
#| echo: false
#| label: fig-premium
#| fig-cap: "Average Premiums"

fig.avg.premium
```
\newpage
\noindent 7. Provide a graph showing the percentage of $0 premium plans over time. Also...remember to format things.


```{r}
#| echo: false
#| label: fig-zero
#| fig-cap: "Share of 0 premium plans"

fig.percent.zero
```
\newpage
# Summary Questions

\vspace{.2in}
\noindent 8. Why did we drop the "800-series" plans?<br>

The 800-series plans may have been dropped because they are not in the average peron’s choice set, meaning they are not accessible to all Medicare Advantage enrollees due to them being Employer Group Waiver Plans. Since they are not available to all enrollees, we don’t want them reflected in our summary of MA enrollment.


\newpage
\noindent 9. Why do so many plans charge a $0 premium? What does that really mean to a beneficiary?<br>

Many plans charge a $0 premium for a couple reasons, firstly that Medicare advantage plans try to attract beneficiaries by having (or appearing to have) lower upfront costs, with premiums being one of the biggest upfront costs. Another reason is that these plans might have higher deductibles and copays, and finally that the government sometimes subsidizes $0 premium plans. What this means for the beneficiary is that they still have to pay a premium for Part B, so they essentially are not paying an additional premium but will still have up front costs. 


\newpage
\noindent 10. Briefly describe your experience working with these data (just a few sentences). Tell me one thing you learned and one thing that really aggravated you.<br>

I had a better experience working with the data the third time around, but still had setbacks here and there which made it a very long process. One thing I learned is how to work in a quarto file and the process of creating a pdf that pulls in data from our analysis. One thing that aggravated me is that I could not figure out how to edit the figures (such as font size on a graph) after saving the image and putting it in the Quarto file, which became an issue when I wanted to make some formatting changes. 

Link to my Github Repository: 
https://github.com/riadharnidharka/Econ470HW1/tree/master 